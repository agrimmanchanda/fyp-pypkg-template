
.. DO NOT EDIT.
.. THIS FILE WAS AUTOMATICALLY GENERATED BY SPHINX-GALLERY.
.. TO MAKE CHANGES, EDIT THE SOURCE PYTHON FILE:
.. "_examples\load_dataset\plot_biomarkers_dist.py"
.. LINE NUMBERS ARE GIVEN BELOW.

.. only:: html

    .. note::
        :class: sphx-glr-download-link-note

        Click :ref:`here <sphx_glr_download__examples_load_dataset_plot_biomarkers_dist.py>`
        to download the full example code

.. rst-class:: sphx-glr-example-title

.. _sphx_glr__examples_load_dataset_plot_biomarkers_dist.py:


Biomarker distributions in dataset
===========================================

Using ``seaborn`` library to visualise biomarker distributions

.. GENERATED FROM PYTHON SOURCE LINES 9-10

Import the relevant libraries first

.. GENERATED FROM PYTHON SOURCE LINES 10-18

.. code-block:: default
   :lineno-start: 10

    import numpy as np 
    import pandas as pd
    import matplotlib.pyplot as plt
    import seaborn as sns
    from scipy import stats
    import warnings
    warnings.filterwarnings("ignore")








.. GENERATED FROM PYTHON SOURCE LINES 19-22

-------------------------------------
Data import 
-------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 22-35

.. code-block:: default
   :lineno-start: 23


    # Set relative data path and set FBC panel list
    path_data = 'datasets/Transformed_First_FBC_dataset.csv'

    FBC_CODES = ["EOS", "MONO", "BASO", "NEUT", "RBC", "WBC", 
                    "MCHC", "MCV", "LY", "HCT", "RDW", "HGB", 
                    "MCH", "PLT", "MPV", "NRBCA"]

    # Read data and drop Nan _uid records
    df = pd.read_csv(path_data).dropna(subset=['pid'])

    df.reset_index(drop=True, inplace=True)








.. GENERATED FROM PYTHON SOURCE LINES 36-39

-------------------------------------
Preprocessing step: obtain FBC panel
-------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 39-45

.. code-block:: default
   :lineno-start: 40


    # Obtain the biomarkers DataFrame only
    biomarkers_df = df[FBC_CODES].dropna(subset=FBC_CODES)
    biomarkers_df_copy = biomarkers_df.copy(deep=True)
    biomarkers_data = biomarkers_df.values








.. GENERATED FROM PYTHON SOURCE LINES 46-49

----------------------------------------------------
Plot distributions and histograms for each biomarker
----------------------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 49-69

.. code-block:: default
   :lineno-start: 50


    for col in biomarkers_df_copy.columns:
        plt.figure(figsize=(20,10))
        plt.suptitle(f'Distribution and boxplot for biomarker: {col}', 
        fontweight='bold', fontsize=25)
    
        plt.subplot(1,2,1)
        sns.distplot(biomarkers_df[col].values, bins=50, 
        kde_kws={'color': 'red','linewidth': 2, }, hist_kws={'edgecolor':'black'})
        plt.xlabel(f'{col}', fontsize=18)
        plt.ylabel('Density', fontsize=18)
        plt.xticks(fontsize=18)
        plt.yticks(fontsize=18)
    
        plt.subplot(1,2,2)
        sns.boxplot(x=biomarkers_df[col])
        plt.xlabel(f'{col}', fontsize=18)
        plt.xticks(fontsize=18)
        plt.yticks(fontsize=18)




.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_001.png
          :alt: Distribution and boxplot for biomarker: EOS
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_002.png
          :alt: Distribution and boxplot for biomarker: MONO
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_003.png
          :alt: Distribution and boxplot for biomarker: BASO
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_004.png
          :alt: Distribution and boxplot for biomarker: NEUT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_005.png
          :alt: Distribution and boxplot for biomarker: RBC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_006.png
          :alt: Distribution and boxplot for biomarker: WBC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_007.png
          :alt: Distribution and boxplot for biomarker: MCHC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_008.png
          :alt: Distribution and boxplot for biomarker: MCV
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_009.png
          :alt: Distribution and boxplot for biomarker: LY
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_010.png
          :alt: Distribution and boxplot for biomarker: HCT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_011.png
          :alt: Distribution and boxplot for biomarker: RDW
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_012.png
          :alt: Distribution and boxplot for biomarker: HGB
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_013.png
          :alt: Distribution and boxplot for biomarker: MCH
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_014.png
          :alt: Distribution and boxplot for biomarker: PLT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_015.png
          :alt: Distribution and boxplot for biomarker: MPV
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_016.png
          :alt: Distribution and boxplot for biomarker: NRBCA
          :class: sphx-glr-multi-img





.. GENERATED FROM PYTHON SOURCE LINES 70-73

-------------------------------------
Plot same histograms without outliers
-------------------------------------

.. GENERATED FROM PYTHON SOURCE LINES 73-106

.. code-block:: default
   :lineno-start: 74


    # Remove data outliers based on absolute Z-Score value < 3
    #biomarkers_df[(np.abs(stats.zscore(biomarkers_df)) < 3).all(axis=1)]

    # Remove values based on Q(1/3) -+ 1.5 * IQR method
    q1, q3 = biomarkers_df.quantile(0.25), biomarkers_df.quantile(0.75)
    IQR = q3 - q1
    lower_bound = q1 - (1.5 * IQR)
    upper_bound = q3 + (1.5 * IQR)

    # New biomarkers dataframe with outlier values removed
    biomarkers_df_wo_outliers = biomarkers_df[~((biomarkers_df < lower_bound) | 
    (biomarkers_df > upper_bound)).any(axis=1)]

    # Plot distribution and boxplots 
    for col in biomarkers_df_wo_outliers.columns:
        plt.figure(figsize=(20,10))
        plt.suptitle(f'Distribution and boxplot for biomarker: {col}', 
        fontweight='bold', fontsize=25)
    
        plt.subplot(1,2,1)
        sns.distplot(biomarkers_df_wo_outliers[col].values, bins=50, 
        kde_kws={'color': 'red','linewidth': 2, }, hist_kws={'edgecolor':'black'})
        plt.xlabel(f'{col}', fontsize=18)
        plt.ylabel('Density', fontsize=18)
        plt.xticks(fontsize=18)
        plt.yticks(fontsize=18)
    
        plt.subplot(1,2,2)
        sns.boxplot(x=biomarkers_df_wo_outliers[col])
        plt.xlabel(f'{col}', fontsize=18)
        plt.xticks(fontsize=18)
        plt.yticks(fontsize=18)



.. rst-class:: sphx-glr-horizontal


    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_017.png
          :alt: Distribution and boxplot for biomarker: EOS
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_018.png
          :alt: Distribution and boxplot for biomarker: MONO
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_019.png
          :alt: Distribution and boxplot for biomarker: BASO
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_020.png
          :alt: Distribution and boxplot for biomarker: NEUT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_021.png
          :alt: Distribution and boxplot for biomarker: RBC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_022.png
          :alt: Distribution and boxplot for biomarker: WBC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_023.png
          :alt: Distribution and boxplot for biomarker: MCHC
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_024.png
          :alt: Distribution and boxplot for biomarker: MCV
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_025.png
          :alt: Distribution and boxplot for biomarker: LY
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_026.png
          :alt: Distribution and boxplot for biomarker: HCT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_027.png
          :alt: Distribution and boxplot for biomarker: RDW
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_028.png
          :alt: Distribution and boxplot for biomarker: HGB
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_029.png
          :alt: Distribution and boxplot for biomarker: MCH
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_030.png
          :alt: Distribution and boxplot for biomarker: PLT
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_031.png
          :alt: Distribution and boxplot for biomarker: MPV
          :class: sphx-glr-multi-img

    *

      .. image:: /_examples/load_dataset/images/sphx_glr_plot_biomarkers_dist_032.png
          :alt: Distribution and boxplot for biomarker: NRBCA
          :class: sphx-glr-multi-img






.. rst-class:: sphx-glr-timing

   **Total running time of the script:** ( 0 minutes  21.676 seconds)


.. _sphx_glr_download__examples_load_dataset_plot_biomarkers_dist.py:


.. only :: html

 .. container:: sphx-glr-footer
    :class: sphx-glr-footer-example



  .. container:: sphx-glr-download sphx-glr-download-python

     :download:`Download Python source code: plot_biomarkers_dist.py <plot_biomarkers_dist.py>`



  .. container:: sphx-glr-download sphx-glr-download-jupyter

     :download:`Download Jupyter notebook: plot_biomarkers_dist.ipynb <plot_biomarkers_dist.ipynb>`


.. only:: html

 .. rst-class:: sphx-glr-signature

    `Gallery generated by Sphinx-Gallery <https://sphinx-gallery.github.io>`_
