

<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  
  <title>Supplementary Experiment I.I.I &mdash; fyp2020-am9717 0.0.1 documentation</title>
  

  
  <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-binder.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-dataframe.css" type="text/css" />
  <link rel="stylesheet" href="../../_static/gallery-rendered-html.css" type="text/css" />

  
  

  
  

  

  
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
    
      <script type="text/javascript" id="documentation_options" data-url_root="../../" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/jquery.js"></script>
        <script src="../../_static/underscore.js"></script>
        <script src="../../_static/doctools.js"></script>
    
    <script type="text/javascript" src="../../_static/js/theme.js"></script>

    
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" />
    <link rel="next" title="Experiment 1: Model Learning" href="plot_bayes_net_exp1_1.html" />
    <link rel="prev" title="Supplementary Experiment I.I" href="bayesnet_supplementary_1.html" /> 
</head>

<body class="wy-body-for-nav">

   
  <div class="wy-grid-for-nav">
    
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >
          

          
            <a href="../../index.html" class="icon icon-home"> fyp2020-am9717
          

          
          </a>

          
            
            
          

          
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>

          
        </div>

        
        <div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="main navigation">
          
            
            
              
            
            
              <p class="caption"><span class="caption-text">Tutorial</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../tutorials/setup.html">Tutorial</a></li>
</ul>
<p class="caption"><span class="caption-text">Experiments</span></p>
<ul class="current">
<li class="toctree-l1"><a class="reference internal" href="../load_dataset/index.html">Overview of pathology data</a></li>
<li class="toctree-l1"><a class="reference internal" href="../iterative_imputer/index.html">Iterative Imputer</a></li>
<li class="toctree-l1 current"><a class="reference internal" href="index.html">Bayesian Networks</a><ul class="current">
<li class="toctree-l2"><a class="reference internal" href="bayesnet_supplementary_1.html">Supplementary Experiment I.I</a></li>
<li class="toctree-l2 current"><a class="current reference internal" href="#">Supplementary Experiment I.I.I</a><ul>
<li class="toctree-l3"><a class="reference internal" href="#libraries-import">Libraries import</a></li>
<li class="toctree-l3"><a class="reference internal" href="#data-import">Data import</a></li>
<li class="toctree-l3"><a class="reference internal" href="#structure-learning">Structure learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#model-topology">Model topology</a></li>
<li class="toctree-l3"><a class="reference internal" href="#visualise-bn">Visualise BN</a></li>
<li class="toctree-l3"><a class="reference internal" href="#parameter-learning">Parameter learning</a></li>
<li class="toctree-l3"><a class="reference internal" href="#generate-test-set-data">Generate test set data</a></li>
<li class="toctree-l3"><a class="reference internal" href="#inference-using-variable-elimination">Inference using Variable Elimination</a></li>
</ul>
</li>
<li class="toctree-l2"><a class="reference internal" href="plot_bayes_net_exp1_1.html">Experiment 1: Model Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bayes_net_exp1_1_1.html">Experiment 1: Model Evaluation</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bayes_net_exp2_1.html">Experiment 2: Model Learning</a></li>
<li class="toctree-l2"><a class="reference internal" href="plot_bayes_net_exp2_1_1.html">Experiment 2: Model Evaluation</a></li>
</ul>
</li>
</ul>

            
          
        </div>
        
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap">

      
      <nav class="wy-nav-top" aria-label="top navigation">
        
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">fyp2020-am9717</a>
        
      </nav>


      <div class="wy-nav-content">
        
        <div class="rst-content">
        
          

















<div role="navigation" aria-label="breadcrumbs navigation">

  <ul class="wy-breadcrumbs">
    
      <li><a href="../../index.html" class="icon icon-home"></a> &raquo;</li>
        
          <li><a href="index.html">Bayesian Networks</a> &raquo;</li>
        
      <li>Supplementary Experiment I.I.I</li>
    
    
      <li class="wy-breadcrumbs-aside">
        
          
            <a href="../../_sources/_examples/bayesian_networks/bayesnet_supplementary_2.rst.txt" rel="nofollow"> View page source</a>
          
        
      </li>
    
  </ul>

  
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
            
  <div class="sphx-glr-download-link-note admonition note">
<p class="admonition-title">Note</p>
<p>Click <a class="reference internal" href="#sphx-glr-download-examples-bayesian-networks-bayesnet-supplementary-2-py"><span class="std std-ref">here</span></a>
to download the full example code</p>
</div>
<div class="sphx-glr-example-title section" id="supplementary-experiment-i-i-i">
<span id="sphx-glr-examples-bayesian-networks-bayesnet-supplementary-2-py"></span><h1>Supplementary Experiment I.I.I<a class="headerlink" href="#supplementary-experiment-i-i-i" title="Permalink to this headline">¶</a></h1>
<p>Using the <code class="docutils literal notranslate"><span class="pre">pgmpy</span></code> library to learn the
structure of Bayesian Network (BN) from the data,
estimate parameters for Conditional Probability
Distributions (CPDs) and imputing missing values.</p>
<div class="section" id="libraries-import">
<h2>Libraries import<a class="headerlink" href="#libraries-import" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>17
18
19
20
21
22
23
24
25
26
27
28
29
30
31
32
33
34
35</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Libraries generic</span>
 <span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
 <span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
 <span class="kn">import</span> <span class="nn">sklearn</span>
 <span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
 <span class="kn">from</span> <span class="nn">math</span> <span class="kn">import</span> <span class="n">isnan</span>

 <span class="c1"># Libraries for BNs</span>
 <span class="kn">import</span> <span class="nn">networkx</span> <span class="k">as</span> <span class="nn">nx</span>
 <span class="kn">from</span> <span class="nn">pgmpy.models</span> <span class="kn">import</span> <span class="n">BayesianModel</span>
 <span class="kn">from</span> <span class="nn">pgmpy.estimators</span> <span class="kn">import</span> <span class="n">HillClimbSearch</span><span class="p">,</span> <span class="n">BDeuScore</span><span class="p">,</span> <span class="n">BicScore</span><span class="p">,</span> <span class="n">BayesianEstimator</span>
 <span class="kn">from</span> <span class="nn">pgmpy.inference</span> <span class="kn">import</span> <span class="n">VariableElimination</span>

 <span class="c1"># Libraries sklearn</span>
 <span class="kn">from</span> <span class="nn">sklearn.model_selection</span> <span class="kn">import</span> <span class="n">train_test_split</span>

 <span class="c1"># Custom Packages</span>
 <span class="kn">from</span> <span class="nn">labimputer.utils.load_dataset</span> <span class="kn">import</span> <span class="n">remove_data_outliers</span>
 <span class="kn">from</span> <span class="nn">labimputer.utils.bayes_net</span> <span class="kn">import</span> <span class="n">get_unique_edges</span><span class="p">,</span> <span class="n">get_row_from_df</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="data-import">
<h2>Data import<a class="headerlink" href="#data-import" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>42
43
44
45
46
47
48
49
50
51
52
53
54
55
56
57
58
59
60
61
62
63
64</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Set relative data path and set FBC panel list</span>
 <span class="n">path_data</span> <span class="o">=</span> <span class="s1">&#39;../resources/datasets/nhs/Transformed_First_FBC_dataset.csv&#39;</span>

 <span class="n">FBC_CODES</span> <span class="o">=</span> <span class="p">[</span><span class="s2">&quot;EOS&quot;</span><span class="p">,</span> <span class="s2">&quot;MONO&quot;</span><span class="p">,</span> <span class="s2">&quot;BASO&quot;</span><span class="p">,</span> <span class="s2">&quot;NEUT&quot;</span><span class="p">,</span> <span class="s2">&quot;RBC&quot;</span><span class="p">,</span> <span class="s2">&quot;WBC&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;MCHC&quot;</span><span class="p">,</span> <span class="s2">&quot;MCV&quot;</span><span class="p">,</span> <span class="s2">&quot;LY&quot;</span><span class="p">,</span> <span class="s2">&quot;HCT&quot;</span><span class="p">,</span> <span class="s2">&quot;RDW&quot;</span><span class="p">,</span> <span class="s2">&quot;HGB&quot;</span><span class="p">,</span>
                 <span class="s2">&quot;MCH&quot;</span><span class="p">,</span> <span class="s2">&quot;PLT&quot;</span><span class="p">,</span> <span class="s2">&quot;MPV&quot;</span><span class="p">,</span> <span class="s2">&quot;NRBCA&quot;</span><span class="p">]</span>

 <span class="c1"># Read data and drop Nan _uid records</span>
 <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">path_data</span><span class="p">)</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;pid&#39;</span><span class="p">])</span>

 <span class="n">df</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Obtain the biomarkers DataFrame only</span>
 <span class="n">raw_data</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">FBC_CODES</span><span class="p">]</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">subset</span><span class="o">=</span><span class="n">FBC_CODES</span><span class="p">)</span>

 <span class="c1"># Remove outliers from dataset</span>
 <span class="n">complete_profiles</span><span class="p">,</span> <span class="n">_</span> <span class="o">=</span> <span class="n">remove_data_outliers</span><span class="p">(</span><span class="n">raw_data</span><span class="p">)</span>

 <span class="c1"># Constant variables to drop</span>
 <span class="n">DROP_FEATURES</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;BASO&#39;</span><span class="p">,</span> <span class="s1">&#39;NRBCA&#39;</span><span class="p">]</span>

 <span class="c1"># Complete profiles for complete case analysis</span>
 <span class="n">complete_profiles</span> <span class="o">=</span> <span class="n">complete_profiles</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">DROP_FEATURES</span><span class="p">,</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="structure-learning">
<h2>Structure learning<a class="headerlink" href="#structure-learning" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>71
72
73
74
75
76
77
78
79
80</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># Use the HillClimbSearch to find the best structure of the graph and use a</span>
 <span class="c1"># Bayesian Information Criterion (BIC) to set a score for the optimisation</span>
 <span class="c1"># problem being solved by HillClimbSearch. For convenience, code has been</span>
 <span class="c1"># commented as it takes a couple of minutes (with high CPU requirement)</span>
 <span class="c1"># to find the edges but the edges found are consistent for BIC and Bayesian</span>
 <span class="c1"># Dirichlet Equivalent Uniform (BDeu).</span>

 <span class="c1"># hc = HillClimbSearch(complete_df, scoring_method=BicScore(complete_df))</span>
 <span class="c1"># best_model = hc.estimate()</span>
 <span class="c1"># print(best_model.edges())</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="model-topology">
<h2>Model topology<a class="headerlink" href="#model-topology" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre> 87
 88
 89
 90
 91
 92
 93
 94
 95
 96
 97
 98
 99
100
101
102
103
104
105
106
107
108
109
110
111</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># edges found from structure learning</span>
 <span class="n">best_model</span> <span class="o">=</span> <span class="p">[</span>
     <span class="p">(</span><span class="s1">&#39;EOS&#39;</span><span class="p">,</span> <span class="s1">&#39;LY&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;MONO&#39;</span><span class="p">,</span> <span class="s1">&#39;WBC&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;WBC&#39;</span><span class="p">,</span> <span class="s1">&#39;NEUT&#39;</span><span class="p">),</span>
     <span class="c1">#(&#39;MCHC&#39;, &#39;MCV&#39;),</span>
     <span class="p">(</span><span class="s1">&#39;LY&#39;</span><span class="p">,</span> <span class="s1">&#39;MONO&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;LY&#39;</span><span class="p">,</span> <span class="s1">&#39;HCT&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;HCT&#39;</span><span class="p">,</span> <span class="s1">&#39;HGB&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;HCT&#39;</span><span class="p">,</span> <span class="s1">&#39;RBC&#39;</span><span class="p">),</span>
     <span class="p">(</span><span class="s1">&#39;HCT&#39;</span><span class="p">,</span> <span class="s1">&#39;RDW&#39;</span><span class="p">),</span>
     <span class="c1">#(&#39;MCH&#39;, &#39;MCV&#39;)</span>
 <span class="p">]</span>

 <span class="c1"># create an instance of Bayesian Model from pgmpy</span>
 <span class="n">model</span> <span class="o">=</span> <span class="n">BayesianModel</span><span class="p">(</span><span class="n">best_model</span><span class="p">)</span>

 <span class="c1"># get only the variables found for BN</span>
 <span class="n">FEATURES</span> <span class="o">=</span> <span class="n">get_unique_edges</span><span class="p">(</span><span class="n">best_model</span><span class="p">)</span>

 <span class="n">complete_profiles</span> <span class="o">=</span> <span class="n">complete_profiles</span><span class="p">[</span><span class="n">FEATURES</span><span class="p">]</span>

 <span class="c1"># get train and test split</span>

 <span class="n">train</span><span class="p">,</span> <span class="n">test</span> <span class="o">=</span> <span class="n">train_test_split</span><span class="p">(</span><span class="n">complete_profiles</span><span class="p">,</span> <span class="n">shuffle</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="visualise-bn">
<h2>Visualise BN<a class="headerlink" href="#visualise-bn" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>118
119
120
121
122</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="n">plt</span><span class="o">.</span><span class="n">figure</span><span class="p">(</span><span class="n">figsize</span><span class="o">=</span><span class="p">(</span><span class="mi">20</span><span class="p">,</span><span class="mi">10</span><span class="p">))</span>

 <span class="n">nx</span><span class="o">.</span><span class="n">draw</span><span class="p">(</span><span class="n">model</span><span class="p">,</span> <span class="n">node_size</span><span class="o">=</span><span class="mi">2000</span><span class="p">,</span> <span class="n">node_color</span><span class="o">=</span><span class="s1">&#39;orange&#39;</span><span class="p">,</span> <span class="n">font_weight</span><span class="o">=</span><span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">with_labels</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="parameter-learning">
<h2>Parameter learning<a class="headerlink" href="#parameter-learning" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>129
130
131
132
133
134
135
136</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># estimate the CPDs for each node in the BN</span>
 <span class="n">model</span><span class="o">.</span><span class="n">fit</span><span class="p">(</span><span class="n">train</span><span class="p">,</span>
     <span class="n">estimator</span><span class="o">=</span><span class="n">BayesianEstimator</span><span class="p">,</span>
     <span class="n">prior_type</span><span class="o">=</span><span class="s2">&quot;BDeu&quot;</span><span class="p">)</span>

 <span class="c1"># show the CPDs</span>
 <span class="k">for</span> <span class="n">cpd</span> <span class="ow">in</span> <span class="n">model</span><span class="o">.</span><span class="n">get_cpds</span><span class="p">():</span>
     <span class="nb">print</span><span class="p">(</span><span class="sa">f</span><span class="s2">&quot;</span><span class="se">\n</span><span class="s2"> </span><span class="si">{cpd}</span><span class="s2">&quot;</span><span class="p">)</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="generate-test-set-data">
<h2>Generate test set data<a class="headerlink" href="#generate-test-set-data" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>143
144
145
146
147
148
149
150
151
152
153
154</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># test with only top 20 columns and set 10% data to NaN</span>

 <span class="n">test</span> <span class="o">=</span> <span class="n">test</span><span class="p">[:</span><span class="mi">20</span><span class="p">]</span>

 <span class="n">tcolumns</span> <span class="o">=</span> <span class="n">test</span><span class="o">.</span><span class="n">columns</span>

 <span class="k">for</span> <span class="n">col</span> <span class="ow">in</span> <span class="n">tcolumns</span><span class="p">:</span>
     <span class="n">test</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">test</span><span class="o">.</span><span class="n">sample</span><span class="p">(</span><span class="n">frac</span><span class="o">=</span><span class="mf">0.1</span><span class="p">)</span><span class="o">.</span><span class="n">index</span><span class="p">,</span> <span class="n">col</span><span class="p">]</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">nan</span>

 <span class="c1"># show test dataframe with NaN values</span>

 <span class="n">test</span>
</pre></div>
</td></tr></table></div>
</div>
<div class="section" id="inference-using-variable-elimination">
<h2>Inference using Variable Elimination<a class="headerlink" href="#inference-using-variable-elimination" title="Permalink to this headline">¶</a></h2>
<div class="highlight-default notranslate"><table class="highlighttable"><tr><td class="linenos"><div class="linenodiv"><pre>161
162
163
164
165
166
167
168
169
170
171
172
173
174
175
176
177
178
179
180
181
182
183
184
185
186
187
188
189
190
191
192
193
194
195
196
197
198
199
200
201
202
203
204
205
206
207</pre></div></td><td class="code"><div class="highlight"><pre><span></span> <span class="c1"># use the variable elimination algorithm</span>
 <span class="n">ve</span> <span class="o">=</span> <span class="n">VariableElimination</span><span class="p">(</span><span class="n">model</span><span class="p">)</span>

 <span class="c1"># dataframe to return imputed test data</span>

 <span class="n">imp_data</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">()</span>

 <span class="c1"># compute inference for each row</span>
 <span class="k">for</span> <span class="n">row</span> <span class="ow">in</span> <span class="n">test</span><span class="o">.</span><span class="n">itertuples</span><span class="p">():</span>
     <span class="c1"># get each row in dataframe as a dictionary</span>
     <span class="n">rowData</span> <span class="o">=</span> <span class="n">get_row_from_df</span><span class="p">(</span><span class="n">row</span><span class="p">,</span> <span class="n">tcolumns</span><span class="p">)</span>

     <span class="c1"># extract the variables with a NaN value</span>
     <span class="n">nan_vars</span> <span class="o">=</span> <span class="p">[</span><span class="n">k</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rowData</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">)]</span>

     <span class="c1"># extract the dict for observed variables i.e. ones with a value</span>
     <span class="n">obs_vars</span> <span class="o">=</span> <span class="p">{</span><span class="n">k</span><span class="p">:</span> <span class="n">v</span> <span class="k">for</span> <span class="n">k</span><span class="p">,</span> <span class="n">v</span> <span class="ow">in</span> <span class="n">rowData</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> <span class="k">if</span> <span class="ow">not</span> <span class="n">isnan</span><span class="p">(</span><span class="n">v</span><span class="p">)}</span>

     <span class="c1"># save a copy of the observed variables dict</span>
     <span class="n">aux</span> <span class="o">=</span> <span class="n">obs_vars</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>

     <span class="c1"># if no observed variables, then leave as is</span>

     <span class="k">if</span> <span class="nb">len</span><span class="p">(</span><span class="n">nan_vars</span><span class="p">)</span> <span class="o">&gt;</span> <span class="mi">0</span><span class="p">:</span>

         <span class="c1"># run BP algorithm and obtain the value for</span>
         <span class="c1"># each of the missing variables</span>

         <span class="n">val</span> <span class="o">=</span> <span class="n">ve</span><span class="o">.</span><span class="n">map_query</span><span class="p">(</span><span class="n">variables</span><span class="o">=</span><span class="n">nan_vars</span><span class="p">,</span>
                             <span class="n">evidence</span><span class="o">=</span><span class="n">obs_vars</span><span class="p">,</span>
                             <span class="n">show_progress</span><span class="o">=</span><span class="kc">False</span><span class="p">)</span>

         <span class="c1"># add the found values back to aux</span>
         <span class="n">aux</span><span class="o">.</span><span class="n">update</span><span class="p">(</span><span class="n">val</span><span class="p">)</span>

         <span class="c1"># add the imputed row data to imp_data DataFrame</span>
         <span class="n">imp_data</span> <span class="o">=</span> <span class="n">imp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">aux</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

         <span class="c1"># loop again</span>
         <span class="k">continue</span>

     <span class="c1"># otherwise just return the row as it is</span>
     <span class="n">imp_data</span> <span class="o">=</span> <span class="n">imp_data</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">rowData</span><span class="p">,</span> <span class="n">ignore_index</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>

 <span class="c1"># Show imputed test dataframe</span>

 <span class="n">imp_data</span>
</pre></div>
</td></tr></table></div>
<p class="sphx-glr-timing"><strong>Total running time of the script:</strong> ( 0 minutes  0.000 seconds)</p>
<div class="sphx-glr-footer class sphx-glr-footer-example docutils container" id="sphx-glr-download-examples-bayesian-networks-bayesnet-supplementary-2-py">
<div class="sphx-glr-download sphx-glr-download-python docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/efc867ac38df356bb713b955ed23b90e/bayesnet_supplementary_2.py"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Python</span> <span class="pre">source</span> <span class="pre">code:</span> <span class="pre">bayesnet_supplementary_2.py</span></code></a></p>
</div>
<div class="sphx-glr-download sphx-glr-download-jupyter docutils container">
<p><a class="reference download internal" download="" href="../../_downloads/09a402cc81b6f5d3a73d9ad0b63c5501/bayesnet_supplementary_2.ipynb"><code class="xref download docutils literal notranslate"><span class="pre">Download</span> <span class="pre">Jupyter</span> <span class="pre">notebook:</span> <span class="pre">bayesnet_supplementary_2.ipynb</span></code></a></p>
</div>
</div>
<p class="sphx-glr-signature"><a class="reference external" href="https://sphinx-gallery.github.io">Gallery generated by Sphinx-Gallery</a></p>
</div>
</div>


           </div>
           
          </div>
          <footer>
    <div class="rst-footer-buttons" role="navigation" aria-label="footer navigation">
        <a href="plot_bayes_net_exp1_1.html" class="btn btn-neutral float-right" title="Experiment 1: Model Learning" accesskey="n" rel="next">Next <span class="fa fa-arrow-circle-right" aria-hidden="true"></span></a>
        <a href="bayesnet_supplementary_1.html" class="btn btn-neutral float-left" title="Supplementary Experiment I.I" accesskey="p" rel="prev"><span class="fa fa-arrow-circle-left" aria-hidden="true"></span> Previous</a>
    </div>

  <hr/>

  <div role="contentinfo">
    <p>
        &#169; Copyright 2021, Agrim Manchanda.

    </p>
  </div>
    
    
    
    Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    
    provided by <a href="https://readthedocs.org">Read the Docs</a>. 

</footer>
        </div>
      </div>

    </section>

  </div>
  

  <script type="text/javascript">
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script>

  
  
    
   

</body>
</html>